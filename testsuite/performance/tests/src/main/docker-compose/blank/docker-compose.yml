version: "2.2"

networks:
    keycloak:
        ipam:
            config:
            - subnet: 10.0.1.0/24

services:

    mariadb:
        image: keycloak_test_sshd:${KEYCLOAK_VERSION:-latest}
        cpuset: ${DB_CPUSET:-1}
        mem_limit: ${DB_MEMLIMIT:-2g}
        networks:
            - keycloak
        ports:
            - "3322:22"
            - "3306:3306"

    keycloak:
        image: keycloak_test_sshd:${KEYCLOAK_VERSION:-latest}
        cpuset: ${KEYCLOAK_CPUSET:-2-3}
        mem_limit: ${KEYCLOAK_MEMLIMIT:-2500m}
        networks:
            - keycloak
        ports:
            - "8022:22"
            - "8080:8080"
            - "9090:9990"
